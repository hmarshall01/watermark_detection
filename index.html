<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AI Detection in Emails</title>

  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <link rel="stylesheet" href="styles.css" />

  <script>
    const gaugeData = [{
      value: 0,
      title: { text: "Probability of AI text", font: { size: 28 } },
      type: "indicator",
      mode: "gauge+number",
      gauge: {
        axis: { range: [0, 100] },
        steps: [
          { range: [0, 50], color: "#F6F5F7" },
          { range: [50, 80], color: "#D3D3D3" },
          { range: [80, 100], color: "#A2A2A2" }
        ],
        bar: { color: "#00F5D4" }
      }
    }];

    const gaugeLayout = { width: 500, height: 380, font: { color: "#6B5B95", family: "Arial" } };
    window.addEventListener("load", () => {
        Plotly.newPlot("myGraph", gaugeData, gaugeLayout);
    });
    window.updateGauge = function(v) {
        Plotly.update("myGraph", { value: v }, {}, [0]);
    };

    async function checkNow() {
      const text = (document.getElementById("email_content").value || "").trim();
      const resultEl = document.getElementById("result");
      if (!text) { resultEl.innerText = "Please paste some text to analyze."; return; }

      try {
        const res = await fetch("/predict", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ text })
        });
        const data = await res.json();
        if (!res.ok) { resultEl.innerText = data.error || "Server error."; return; }
        updateGauge(data.score || 0);
        resultEl.innerText = data.message || "";
      } catch {
        resultEl.innerText = "Could not reach the server. Is it running?";
      }
    }


  </script>
</head>
<body>
  <div id="container">
    <header class="header">
      <h1>AI Detection in Phishing Emails</h1>
      <p>Analyze suspected phishing emails and predict whether the text was generated by AI.</p>
    </header>

    <div id="myGraph" style="width:100%;height:380px;"></div>

    <p id="result" style="font-weight:600;"></p>

    <label for="email_content"><strong>Please enter an email below to determine if it is AI or human written:</strong></label>
    <textarea id="email_content" name="email_content" rows="16" cols="100" placeholder="Paste email text here..."></textarea>
    <br />
    <button id="check_button" type="button" onclick="checkNow()">Check now</button>
  </div>
</body>
</html>
